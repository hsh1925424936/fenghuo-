define(["position","oasisUf"],function(e){var t=[];$.oasUiFactory("oasPopover",{VERSION:"1.0.0",options:{animation:!0,html:!1,placement:"",selector:!1,trigger:"click",focusoutClose:!0,title:"",content:"",delay:0,container:!1,viewport:{selector:"body",padding:0}},_create:function(){var e=this.options,n=this,r=e.trigger,i=e.focusoutClose,s=r.split(" ");for(var o=0,u=s.length;o<u;o++){var a=s[o];if(a==="click")this.$el.on("click."+this.uiName,this.$el,function(e){n._toggle.call(n,$(e.target))}),i&&t.push(this.$el);else if(a!=="manual"){var f=a==="hover"?"mouseenter":"focusin",l=a==="hover"?"mouseleave":"focusout";a==="focus"&&t.push(this.$el),this.$el.on(f+"."+this.uiName,this.$el,$.proxy(this._enter,this)),this.$el.on(l+"."+this.uiName,this.$el,$.proxy(this._leave,this))}}},_enter:function(){var e=this.options,t=this.$el.data("oasPopover").status,n=this.options.placement,r=this.options.content,i=this.options.title,s=this.options.animation;t||(this.status=!0,this._openPopover(n,i,r,s))},_leave:function(){var e=this.options,t=this.$el.data("oasPopover").status;t&&(this.status=!1,this._closePopover())},_Place2Param:function(){var e=this.options.placement,t={top:1,right:2,bottom:3,left:4};return t[e]},_toggle:function(e){var t=this.$el.data("oasPopover").status,n=this.options.placement,r=this._getContent(),i=this._getTitle(),s=this.options.animation;t?e.closest(".popover")[0]!==this.popoverItem[0]&&this._closePopover():this._openPopover(n,i,r,s)},_openPopover:function(e,t,n,r){this.status=!0,this._emit("beforeShow",[this.$el]);var i=this.options,s=this,o=this.options.delay;o=typeof o=="object"?o.hide:o,html='<div class="popover'+(r?" fade ":" ")+e+'">'+'<div class="arrow"></div>'+'<h3 class="popover-title">'+t+"</h3>"+'<div class="popover-content">'+n+"</div>"+"</div>",$html=$(html),this.popoverItem&&this.popoverItem.remove(),this.popoverItem=$html,$html.css("display","block"),t||$html.find(".popover-title").css("display","none"),i.html?$html.find(".popover-content").html(i.content):$html.find(".popover-content").text(i.content),this._emit("show",[this.$el]),this.closeTimeout&&clearTimeout(this.closeTimeout),this.openTimeout=setTimeout(function(){s.options.container?$html.appendTo(s.options.container):$html.insertAfter(s.$el),s._setPosition(s.$el,$html,i.placement),setTimeout(function(){$html.addClass("in"),setTimeout(function(){s._emit("shown",[s.$el,s.popoverItem])},150)},0)},o)},_getTitle:function(){var e=this.options,t;return t=typeof e.title=="function"?e.title.call(this.$el[0]):e.title,t},_getContent:function(){var e=this.options,t;return t=typeof e.content=="function"?e.content.call(this.$el[0]):e.content,t},_closePopover:function(){this._emit("hide",[this.$el,this.$html]);var e=this.options.animation,t=this.options.delay,t=typeof this.options.delay=="object"?t.hide:t,n=this;this.openTimeout&&clearTimeout(this.openTimeout),this.closeTimeout=setTimeout(function(){n.popoverItem&&n.popoverItem.removeClass("in"),setTimeout(function(){n.popoverItem&&n.popoverItem.remove(),n.status=!1,n._emit("hidden",[n.$el,n.popoverItem])},150)},t)},_setPosition:function(t,n,r){n.offset(e.getPosition(t,n,r))},invoke:{hide:function(){var e=this.options,t=this.$el.data("oasPopover").status;this._closePopover()},show:function(){var e=this.options,t=this.$el.data("oasPopover").status,n=this.options.placement,r=this._getContent(),i=this._getTitle(),s=this.options.animation;this._openPopover(n,i,r,s)},toggle:function(){this._toggle()},content:function(e){var t=this.options,n=this.popoverItem,r=this.$el,i=t.placement;t.content=e},setContent:function(e){var t=this.options,n=this.popoverItem,r=this.$el,i=t.placement;t.content=e,t.html?n.find(".popover-content").html(e):n.find(".popover-content").text(e)}}}),$(document).on("click.oasPopoverHide",function(e){var n=$(e.target),r=null,i=null,s=[];for(var o=0,u=t.length;o<u;o++)i=t[o],i.data("oasPopover")&&(r=i.data("oasPopover").popoverItem,n.closest(i).length===0&&n!==i&&n.closest(r).length===0&&n!==r&&r&&r.hasClass("in")&&i.oasPopover("hide"))})});