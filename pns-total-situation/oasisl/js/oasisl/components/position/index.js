define(["oasisUf"],function(e){function a(e){e=p(e)||{},e.nodeType&&(e={element:e});var t=p(e.element)||n;if(t.nodeType!==1)throw new Error("posObject.element is invalid.");var r={element:t,x:e.x||0,y:e.y||0},i=t===n||t._id==="VIEWPORT";return r.offset=function(){return isPinFixed?{left:0,top:0}:i?{left:$(document).scrollLeft(),top:$(document).scrollTop()}:d($(t)[0])},r.size=function(){var e=i?$(window):$(t);return{width:e.outerWidth(),height:e.outerHeight()}},r}function f(e){e.x=l(e.x,e,"width"),e.y=l(e.y,e,"height")}function l(e,t,n){e+="",e=e.replace(/px/gi,""),/\D/.test(e)&&(e=e.replace(/(?:top|left)/gi,"0%").replace(/center/gi,"50%").replace(/(?:bottom|right)/gi,"100%")),e.indexOf("%")!==-1&&(e=e.replace(/(\d+(?:\.\d+)?)%/gi,function(e,r){return t.size()[n]*(r/100)}));if(/[+\-*\/]/.test(e))try{e=(new Function("return "+e))()}catch(r){throw new Error("Invalid position value: "+e)}return h(e)}function c(e){var t=e.offsetParent();t[0]===document.documentElement&&(t=$(document.body)),s&&t.css("zoom",1);var n;return t[0]===document.body&&t.css("position")==="static"?n={top:0,left:0}:n=d(t[0]),n.top+=h(t.css("border-top-width")),n.left+=h(t.css("border-left-width")),n}function h(e){return parseFloat(e,10)||0}function p(e){return $(e)[0]}function d(e){var t=e.getBoundingClientRect(),n=document.documentElement;return{left:t.left+(window.pageXOffset||n.scrollLeft)-(n.clientLeft||document.body.clientLeft||0),top:t.top+(window.pageYOffset||n.scrollTop)-(n.clientTop||document.body.clientTop||0)}}var t={},n={_id:"VIEWPORT",nodeType:1},r=!1,i=(window.navigator.userAgent||"").toLowerCase(),s=i.indexOf("msie 6")!==-1,o=function(e,t,n){return n===0?(t-e)/2:n===-1?t-e:0},u={"^":function(e,t,n){var r=e.outerWidth(),i=t.outerWidth();return{x:o(r,i,n),y:-e.outerHeight()}},v:function(e,t,n){var r=e.outerWidth(),i=t.outerWidth();return{x:o(r,i,n),y:t.outerHeight()}},">":function(e,t,n){var r=e.outerHeight(),i=t.outerHeight();return{x:t.outerWidth(),y:o(r,i,n)}},"<":function(e,t,n){var r=e.outerHeight(),i=t.outerHeight();return{x:-e.outerWidth(),y:o(r,i,n)}}};return t.isOutLeft=function(e,t,n){var r=n?n.offset().left:0,i=n?n.scrollLeft():0,s=n?n.outerWidth():$(window).width();return e<r},t.isOutRight=function(e,t,n){var r=n?n.offset().left:0,i=n?n.scrollLeft():0,s=n?n.outerWidth():$(window).width();return e-r-i+t.outerWidth()>s},t.isOutTop=function(e,t,n){var r=n?n.offset().top:0,i=n?n.scrollTop():0,s=n?n.outerHeight():$(window).height();return e<r},t.isOutBottom=function(e,t,n){var r=n?n.offset().top:0,i=n?n.scrollTop():0,s=n?n.outerHeight():$(window).height();return e-r-i+t.outerHeight()>s},t.pin=function(e,n,r,i,s,o,u){var a={">":"Right","<":"Left","^":"Top",v:"Bottom"},f={">":"<","<":">",v:"^","^":"v"},l={">":["Top","Bottom"],"<":["Top","Bottom"],"^":["Left","Right"],v:["Left","Right"]},c=t.getPinOffset(e,n,r,i,s,o),h=$(e.element),p=i==="<"||i===">"?c.left:c.top,d=t["isOut"+a[i]](p,h,r),v=t["isOut"+a[f[i]]](p,h,r);if(i&&s!==undefined&&u){d&&!v&&(i=f[i],c=t.getPinOffset(e,n,r,i,s,o));var m=i==="<"||i===">"?c.top:c.left,g=i==="<"||i===">"?c.top:c.left,y=t["isOut"+l[i][0]](m,h,r),b=t["isOut"+l[i][1]](g,h,r);s=y?b?s:1:b?-1:s,c=t.getPinOffset(e,n,r,i,s,o)}return h.css({left:c.left,top:c.top}),{direction:a[i],alignType:s}},t.getPinOffset=function(e,t,n,r,i,o){var l=0,h=0;r&&o&&(l=(r===">"?1:-1)*o,h=(r==="v"?1:-1)*o),e=a(e),t=a(t);var p=$(e.element),d=$(t.element),v;p.css("position")!=="fixed"||s?(p.css("position","absolute"),isPinFixed=!1):isPinFixed=!0,f(e),f(t);var m=c(p),g=t.offset();r&&i!==undefined&&(v=u[r](p,d,i));var y=g.top+t.y-e.y-m.top+(v?v.y:0),b=g.left+t.x-e.x-m.left+(v?v.x:0);return n&&(y+=n.scrollTop(),b+=n.scrollLeft()),{left:b+l,top:y+h}},t.center=function(e,n){t.pin({element:e,x:"50%",y:"50%"},{element:n,x:"50%",y:"50%"})},t.advPin=function(e,t,n){e=$(e),t=$(t);var r=t.outerWidth(),i=t.outerHeight(),s=t.offset().left,o=t.offset().top,u=e.outerWidth(),a=e.outerHeight(),f=e.offset().left,l=e.offset().top,c=$(document).scrollTop(),h=$(document).scrollLeft(),p=$(window).height(),d=$(window).width(),v;arguments.length===2?n={direction:"v"}:arguments.length===3&&typeof n=="string"&&(n={direction:n}),e.css("position")!=="fixed"&&e.css("position","absolute"),n.offset&&(v=n.offset);if(n.direction=="v"){var m=p-(o-c+i+a),g,y;v?(g=o+v[0],y=s+v[1]):(g=o,y=s),m>0?e.css({top:g+i,left:y}):o-c<a?e.css({top:g+i,left:y}):e.css({top:g-a,left:y})}else if(n.direction=="h"){var b=d-(s-h+r+u);v?(g=o+v[0],y=s+v[1]):(g=o,y=s),b>0?e.css({left:y+r,top:g}):s-h<u?e.css({left:y+r,top:g}):e.css({left:y-u,top:g})}},t.location=function(e,t){e=$(e);var n=e.outerWidth(),r=e.outerHeight(),i=e.offset().left,s=e.offset().top,o=$(document).scrollTop(),u=$(document).scrollLeft(),a=$(window).height(),f=$(window).width(),l=$(document).height(),c=$(document).width();return t=="fixed"?{top:s-o,right:f-(i-u)-n,bottom:a-(s-o)-r,left:i-u}:{top:s,right:c-i-n,bottom:l-s-r,left:i}},t.overlapArea=function(e,t){var n=e.offset(),r=n.left,i=n.top,s=e.width(),o=e.height(),u=t.offset(),a=u.left,f=u.top,l=t.width(),c=t.height();if(r+s<a||a+l<r||i+o<f||f+c<i)return 0;var h=r-a,p,d=i-f,v;return p=h<0?s-Math.abs(h):l-h,v=d<0?o-Math.abs(d):c-d,[p,v]},t.VIEWPORT=n,t});