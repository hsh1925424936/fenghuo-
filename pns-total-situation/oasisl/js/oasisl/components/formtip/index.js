define(["oasisUf","validate"],function(){"use strict";$.oasUiFactory("oasFormTip",{options:{},_create:function(e){var t=this.$el,n=this.options,r=this;this.$remind,this.$error,this.upArrow=!1,this.$remind=this._createFormTip(),this.$error=this._createErrorFormTip(),t.attr("oaserrormsg")!=null&&t.parent().addClass("has-error"),this._bindEvent(this.$remind,this.$error,e)},_createFormTip:function(){var e=$('<div class="oas-formtip"><div class="formtip-arrow"></div><div class="formtip-inner"></div></div>');return e},_createErrorFormTip:function(){var e=this._createFormTip();return e.addClass("oas-error"),e},_setPosition:function(e,t){this._setUpArrow(e.offset().top,t.height()),this.upArrow?(t.addClass("bottom").removeClass("top"),t.css({position:"absolute"}).offset({top:e.offset().top+e.height()+14,left:e.offset().left})):(t.addClass("top").removeClass("bottom"),t.css({position:"absolute"}).offset({top:e.offset().top-t.height()-14,left:e.offset().left}))},_bindEvent:function(e,t,n){var r=this.$el,i=this.options,s=this;r.off("mouseover"),r.on("mouseover",function(){$(this).attr("oaserrormsg")!=null?(e.remove(),n?n.append(t):$("body").append(t),t.css("max-width",r.outerWidth()),$(".formtip-inner",t).text($(this).attr("oaserrormsg")),s._setPosition($(this),t),t.show()):$(this).attr("oasmsg")!=null&&(n?n.append(e):$("body").append(e),e.css("max-width",r.outerWidth()),$(this).unbind("hover"),$(".formtip-inner",e).text($(this).attr("oasmsg")),s._setPosition($(this),e),e.show())}).on("mouseout",function(){e.remove(),t.remove()})},_setUpArrow:function(e,t){e-12<t?this.upArrow=!0:this.upArrow=!1},invoke:{message:function(e,t,n){var r=this.$el;switch(t){case"oasmsg":e=e?e:"",r.attr("oasmsg",e);break;case"oaserrormsg":e=e?e:"",r.attr("oaserrormsg",e);break;default:e=e?e:"",r.attr("oasmsg",e)}this._create(n)},remove:function(e){var t=this.$el;e==="oaserrormsg"?(t.parent().removeClass("has-error"),t.removeAttr("oaserrormsg"),this.$error.remove()):e==="oasmsg"?(t.removeAttr("oasmsg"),this.$remind.remove()):(t.parent().removeClass("has-error"),t.removeAttr("oaserrormsg"),t.removeAttr("oasmsg"),this.$error.remove(),this.$remind.remove()),this._create()}}}),$("form input[type=text],form input[type=password],form input[type=search],form input[type=url],form input[type=tel],form input[type=email],form input[type=number],form textarea").oasFormTip();var e=window;e.OasFormTip={},e.OasFormTip.open=function(e,t,n,r){$(e).oasFormTip(),$(e).oasFormTip("message",t,n,r)},e.OasFormTip.remove=function(e,t){e?($(e).oasFormTip(),$(e).oasFormTip("remove",t)):$("body").find(":oasFormTip").oasFormTip("remove")},$.validator&&$.validator.setDefaults({showErrors:function(e,t){var n=this.settings.container;if(!t.length)OasFormTip.remove(this.lastElement);else for(var r=0,i=t.length;r<i;r++){var s=t[r].element;OasFormTip.open(s,t[r].message,"oaserrormsg",n)}}})});